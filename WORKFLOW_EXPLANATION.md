# ğŸ“Š è‡ªå‹•åŒ–Workeræµç¨‹èªªæ˜

## ğŸ”„ å®Œæ•´çš„è‡ªå‹•åŒ–æµç¨‹

### 1. **èƒŒæ™¯ç›£æ§éšæ®µ**
```
æ¯30åˆ†é˜è‡ªå‹•åŸ·è¡Œï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. é€£æ¥MongoDB                               â”‚
â”‚ 2. ç²å–ä»Šå¤©çš„æ‰€æœ‰symbols                      â”‚
â”‚ 3. æ¯”è¼ƒå·²è™•ç†çš„symbolsåˆ—è¡¨                    â”‚
â”‚ 4. è­˜åˆ¥æ–°çš„symbols                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2. **æ–°Symbolè™•ç†éšæ®µ**
```
å°æ¯å€‹æ–°symbolåŸ·è¡Œï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 1: è‚¡ç¥¨æ•¸æ“šè™•ç†                          â”‚
â”‚   â”œâ”€â”€ èª¿ç”¨ process_single_stock()           â”‚
â”‚   â”œâ”€â”€ ç²å–æ–°èæ•¸æ“š                           â”‚
â”‚   â”œâ”€â”€ ç²å–åŸºæœ¬é¢æ•¸æ“š                         â”‚
â”‚   â”œâ”€â”€ ç”Ÿæˆä¸­è‹±æ–‡ç¿»è­¯                         â”‚
â”‚   â””â”€â”€ ç”Ÿæˆåˆ†æå ±å‘Š                           â”‚
â”‚                                             â”‚
â”‚ Step 2: å ±å‘Šç”Ÿæˆ                             â”‚
â”‚   â”œâ”€â”€ ç”ŸæˆMarkdownå ±å‘Š                       â”‚
â”‚   â”œâ”€â”€ ç”Ÿæˆä¸­æ–‡PDFå ±å‘Š                        â”‚
â”‚   â””â”€â”€ ç”Ÿæˆè‹±æ–‡PDFå ±å‘Š                        â”‚
â”‚                                             â”‚
â”‚ Step 3: IG Postç”Ÿæˆ                         â”‚
â”‚   â”œâ”€â”€ ä½¿ç”¨ä¸­æ–‡å ±å‘Šå…§å®¹ä½œç‚ºåŸºç¤                â”‚
â”‚   â”œâ”€â”€ èª¿ç”¨IgPostCreatorç”Ÿæˆè²¼æ–‡              â”‚
â”‚   â”œâ”€â”€ ç”ŸæˆInstagramæ ¼å¼å…§å®¹å’Œhashtags        â”‚
â”‚   â””â”€â”€ ä¿å­˜ç‚ºèˆ‡Streamlitä¸€è‡´çš„æ ¼å¼            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“ æ–‡ä»¶çµæ§‹è©³è§£

### **èˆ‡Streamlitæ‡‰ç”¨å®Œå…¨ä¸€è‡´**

```
project_root/
â”œâ”€â”€ data/                           # æ•¸æ“šç›®éŒ„
â”‚   â””â”€â”€ 2025-01-27/                # æ—¥æœŸç›®éŒ„
â”‚       â”œâ”€â”€ AAPL/                  # è‚¡ç¥¨ä»£ç¢¼ç›®éŒ„
â”‚       â”‚   â”œâ”€â”€ news_2025-01-27.json              # åŸå§‹æ–°èæ•¸æ“š
â”‚       â”‚   â”œâ”€â”€ fundamentals_2025-01-27.json      # åŸºæœ¬é¢æ•¸æ“š
â”‚       â”‚   â”œâ”€â”€ desc_en_2025-01-27.json          # è‹±æ–‡å…¬å¸æè¿°
â”‚       â”‚   â”œâ”€â”€ desc_cn_2025-01-27.json          # ä¸­æ–‡å…¬å¸æè¿°
â”‚       â”‚   â”œâ”€â”€ news_cn_2025-01-27.json          # ä¸­æ–‡æ–°èç¿»è­¯
â”‚       â”‚   â”œâ”€â”€ news_en_2025-01-27.json          # è‹±æ–‡æ–°èç¿»è­¯
â”‚       â”‚   â”œâ”€â”€ analysis_2025-01-27.json         # ä¸­æ–‡åˆ†æå ±å‘Š
â”‚       â”‚   â”œâ”€â”€ analysis_en_2025-01-27.json      # è‹±æ–‡åˆ†æå ±å‘Š
â”‚       â”‚   â”œâ”€â”€ AAPL_report_2025-01-27.md        # ä¸»è¦Markdownå ±å‘Š
â”‚       â”‚   â”œâ”€â”€ AAPL_report_chinese_2025-01-27.pdf  # ä¸­æ–‡PDFå ±å‘Š
â”‚       â”‚   â”œâ”€â”€ AAPL_report_english_2025-01-27.pdf  # è‹±æ–‡PDFå ±å‘Š
â”‚       â”‚   â””â”€â”€ AAPL_ig_post_2025-01-27.txt      # Instagramè²¼æ–‡ï¼ˆæ ¼å¼åŒ–å…§å®¹+hashtags+raw JSONï¼‰
â”‚       â”œâ”€â”€ TSLA/                  # å¦ä¸€å€‹è‚¡ç¥¨çš„ç›®éŒ„
â”‚       â”‚   â””â”€â”€ ...                # ç›¸åŒçš„æ–‡ä»¶çµæ§‹
â”‚       â””â”€â”€ ...
â””â”€â”€ logs/                          # æ—¥èªŒç›®éŒ„
    â””â”€â”€ auto_worker_20250127.log   # æ¯æ—¥æ—¥èªŒæ–‡ä»¶
```

## ğŸ”— èˆ‡Streamlitçš„æ•´åˆ

### **å®Œç¾å…¼å®¹**

1. **ç›¸åŒçš„FileManager**: ä½¿ç”¨ç›¸åŒçš„`FileManager`é¡åˆ¥
2. **ç›¸åŒçš„è·¯å¾‘é‚è¼¯**: `data/{YYYY-MM-DD}/{SYMBOL}/`
3. **ç›¸åŒçš„æ–‡ä»¶å‘½å**: èˆ‡Streamlitæ‡‰ç”¨å®Œå…¨ä¸€è‡´
4. **ç›¸åŒçš„æ•¸æ“šæ ¼å¼**: JSONå’ŒMarkdownæ ¼å¼å®Œå…¨åŒ¹é…

### **Streamlitæª¢æ¸¬é‚è¼¯**

ç•¶ä½ æ‰“é–‹Streamlitæ‡‰ç”¨æ™‚ï¼š

```python
# Streamlitæ‡‰ç”¨æœƒæª¢æŸ¥é€™äº›æ–‡ä»¶æ˜¯å¦å­˜åœ¨
data_path = Path(app.file_manager._get_data_path(symbol, app.today_str))
md_file_path = data_path / f"{symbol}_report_{app.today_str}.md"
chinese_pdf_path = data_path / f"{symbol}_report_chinese_{app.today_str}.pdf"
english_pdf_path = data_path / f"{symbol}_report_english_{app.today_str}.pdf"

# å¦‚æœæ–‡ä»¶å­˜åœ¨ï¼Œç›´æ¥é¡¯ç¤º
if md_file_path.exists():
    # é¡¯ç¤ºå·²å­˜åœ¨çš„å ±å‘Š
    with open(md_file_path, 'r', encoding='utf-8') as f:
        md_content = f.read()
```

## âš™ï¸ æ ¸å¿ƒçµ„ä»¶èªªæ˜

### **AutoWorker** (`run_streamlit_auto.py`)
- ä¸»è¦çš„èƒŒæ™¯æœå‹™
- è™•ç†æ’ç¨‹å’Œç›£æ§
- å”èª¿å„å€‹çµ„ä»¶

### **ReportGenerator** (`report_generator.py`)
- è² è²¬å ±å‘Šç”Ÿæˆ
- èˆ‡Streamlitæ‡‰ç”¨ä½¿ç”¨ç›¸åŒçš„é‚è¼¯
- æ”¯æŒä¸­è‹±æ–‡PDFç”Ÿæˆ

### **IgPostCreator** (`ig_post.py`)
- Instagramè²¼æ–‡ç”Ÿæˆå™¨
- åŸºæ–¼åˆ†æå ±å‘Šå‰µå»ºç¤¾äº¤åª’é«”å…§å®¹

### **MongoHandler** (`mongo_db.py`)
- MongoDBæ“ä½œ
- ç²å–æœ€æ–°çš„symbolsæ•¸æ“š

### **FileManager** (`file_manager.py`)
- æ–‡ä»¶ç®¡ç†å’Œè·¯å¾‘è™•ç†
- ç¢ºä¿èˆ‡Streamlitå®Œå…¨ä¸€è‡´

## ğŸ“Š æ•¸æ“šæµèªªæ˜

```
MongoDB (symbols) 
    â†“
AutoWorker (æª¢æ¸¬æ–°symbols)
    â†“
process_single_stock() (ç”ŸæˆåŸºç¤æ•¸æ“š)
    â†“
ReportGenerator (ç”Ÿæˆå ±å‘Š)
    â†“
IgPostCreator (ç”Ÿæˆè²¼æ–‡)
    â†“
æ–‡ä»¶ä¿å­˜åˆ° data/ ç›®éŒ„
    â†“
Streamlitæ‡‰ç”¨è‡ªå‹•æª¢æ¸¬ä¸¦é¡¯ç¤º
```

## ğŸ¯ é—œéµå„ªå‹¢

1. **é›¶å¹²é **: å®Œå…¨è‡ªå‹•åŒ–ï¼Œç„¡éœ€æ‰‹å‹•æ“ä½œ
2. **å®Œç¾æ•´åˆ**: èˆ‡ç¾æœ‰Streamlitæ‡‰ç”¨ç„¡ç¸«éŠœæ¥
3. **ä¸€è‡´æ€§**: æ–‡ä»¶æ ¼å¼å’Œè·¯å¾‘å®Œå…¨ä¸€è‡´
4. **å¯è¦‹æ€§**: Streamlitä¸­ç«‹å³å¯è¦‹è‡ªå‹•ç”Ÿæˆçš„å ±å‘Š
5. **å¯é æ€§**: å¼·å¥çš„éŒ¯èª¤è™•ç†å’Œé‡è©¦æ©Ÿåˆ¶

## ğŸ”§ è‡ªå®šç¾©é…ç½®

### **ä¿®æ”¹åŸ·è¡Œé »ç‡**
åœ¨ `run_streamlit_auto.py` ä¸­ï¼š
```python
# æ¯15åˆ†é˜åŸ·è¡Œä¸€æ¬¡
schedule.every(15).minutes.do(self.run_once)

# æ¯2å°æ™‚åŸ·è¡Œä¸€æ¬¡
schedule.every(2).hours.do(self.run_once)
```

### **ä¿®æ”¹å·¥ä½œæ™‚é–“**
æ ¹æ“šä½ çš„éœ€æ±‚ï¼ˆåŸå§‹è¨»é‡‹æåˆ°å¾5amåˆ°8pm ESTï¼‰ï¼š
```python
# åªåœ¨å·¥ä½œæ™‚é–“é‹è¡Œ
def should_run():
    from datetime import datetime
    from zoneinfo import ZoneInfo
    
    est_time = datetime.now(ZoneInfo("America/New_York"))
    return 5 <= est_time.hour <= 20

if should_run():
    self.run_once()
```

## ğŸ‰ ä½¿ç”¨æ•ˆæœ

**å•Ÿå‹•Workerå¾Œ**ï¼š
1. âœ… Workeråœ¨èƒŒæ™¯é»˜é»˜é‹è¡Œ
2. âœ… æ¯30åˆ†é˜è‡ªå‹•æª¢æŸ¥æ–°symbols
3. âœ… è‡ªå‹•ç”Ÿæˆå®Œæ•´å ±å‘Šå’Œè²¼æ–‡
4. âœ… æ‰“é–‹Streamlitå³å¯çœ‹åˆ°æœ€æ–°å ±å‘Š
5. âœ… ç„¡éœ€ä»»ä½•æ‰‹å‹•æ“ä½œ

**å®Œç¾çš„è‡ªå‹•åŒ–é«”é©—ï¼** ğŸš€
